<!--tang-poetry.wxml-->
<view class="container">
  <!-- æ¸¸æˆä¿¡æ¯æ  -->
  <view class="game-header">
    <view class="info-section">
      <view class="info-item">
        <text class="info-label">è¿›åº¦</text>
        <text class="info-value">{{currentPoemIndex + 1}}/{{totalPoems}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">å¾—åˆ†</text>
        <text class="info-value">{{score}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ—¶é—´</text>
        <text class="info-value">{{timeDisplay}}</text>
      </view>
    </view>
    <view class="difficulty-section">
      <view 
        class="difficulty-btn {{difficulty === 'easy' ? 'active' : ''}}"
        data-difficulty="easy"
        bindtap="onDifficultyChange"
      >
        ç®€å•
      </view>
      <view 
        class="difficulty-btn {{difficulty === 'medium' ? 'active' : ''}}"
        data-difficulty="medium"
        bindtap="onDifficultyChange"
      >
        ä¸­ç­‰
      </view>
      <view 
        class="difficulty-btn {{difficulty === 'hard' ? 'active' : ''}}"
        data-difficulty="hard"
        bindtap="onDifficultyChange"
      >
        å›°éš¾
      </view>
    </view>
    <view class="game-controls">
      <button 
        wx:if="{{gameStatus === 'ready' || gameStatus === 'completed'}}" 
        class="control-btn start-btn" 
        bindtap="{{gameStatus === 'ready' ? 'startGame' : 'restart'}}"
      >
        {{gameStatus === 'ready' ? 'å¼€å§‹' : 'é‡æ–°å¼€å§‹'}}
      </button>
    </view>
  </view>

  <!-- è¯—æ­Œå†…å®¹ -->
  <view class="poem-section" wx:if="{{currentQuestion}}">
    <view class="poem-header">
      <text class="poem-title">{{currentQuestion.poem.title}}</text>
      <text class="poem-author">{{currentQuestion.poem.author}}</text>
    </view>
    
    <view class="poem-content" wx:if="{{currentQuestion && currentQuestion.displayLines && currentQuestion.displayLines.length > 0}}">
      <view 
        class="poem-line"
        wx:for="{{currentQuestion.displayLines}}" 
        wx:for-item="line"
        wx:for-index="lineIndex"
        wx:key="line-{{lineIndex}}"
      >
        <view class="line-content" wx:if="{{line && line.length > 0}}">
          <view 
            class="poem-word {{word.isBlank ? 'blank' : ''}} {{word.isBlank && word.text ? 'filled' : ''}}"
            wx:for="{{line}}" 
            wx:for-item="word"
            wx:for-index="wordIndex"
            wx:key="word-{{lineIndex}}-{{wordIndex}}"
          >
            <text class="word-text">{{word.text}}</text>
          </view>
        </view>
        <text class="poem-punctuation" wx:if="{{currentQuestion.displayLines && lineIndex < currentQuestion.displayLines.length}}">
          {{ lineIndex % 2 === 0 ? 'ï¼Œ' : 'ã€‚' }}
        </text>
      </view>
    </view>
  </view>

  <!-- é€‰é¡¹åŒºåŸŸ -->
  <view class="options-section" wx:if="{{currentQuestion && currentQuestion.blanks.length > 0}}">
    <view 
      class="blank-group"
      wx:for="{{currentQuestion.blanks}}" 
      wx:for-item="blank"
      wx:for-index="blankIndex"
      wx:key="blank-{{blankIndex}}"
    >
      <view class="blank-label">ç¬¬{{blankIndex + 1}}ä¸ªç©ºï¼š</view>
      <view class="options-grid">
        <view 
          class="option-btn {{currentQuestion.userAnswers[blankIndex] === option ? 'selected' : ''}}"
          wx:for="{{currentQuestion.options[blankIndex]}}" 
          wx:for-item="option"
          wx:for-index="optionIndex"
          wx:key="option-{{blankIndex}}-{{optionIndex}}"
          data-blank-index="{{blankIndex}}"
          data-option-index="{{optionIndex}}"
          bindtap="onOptionTap"
        >
          {{option}}
        </view>
      </view>
    </view>
  </view>

  <!-- æ¸¸æˆè¯´æ˜ -->
  <view class="game-tips">
    <text class="tips-text">ğŸ’¡ é€‰æ‹©æ­£ç¡®çš„å­—è¯è¡¥å…¨è¯—å¥ï¼Œå®Œæˆæ‰€æœ‰è¯—æ­Œå³å¯é€šå…³ï¼</text>
  </view>
</view>
